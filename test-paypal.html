<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PayPal Test ‚Äî ProfPilot</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body {
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 p-8">
  
  <div class="max-w-2xl mx-auto">
    <h1 class="text-3xl font-bold text-slate-900 mb-8">PayPal Integration Test</h1>
    
    <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
      <h2 class="text-xl font-semibold mb-4">Test Payment</h2>
      <p class="text-slate-600 mb-6">This is a test payment using PayPal sandbox. Use test credentials to complete the payment.</p>
      
      <div class="mb-6">
        <h3 class="font-medium mb-2">Test Credentials:</h3>
        <div class="bg-slate-100 p-4 rounded-lg text-sm">
          <p><strong>Buyer Account:</strong> sb-buyer@personal.example.com</p>
          <p><strong>Password:</strong> password123</p>
        </div>
      </div>
      
      <div id="paypal-button-container" class="mb-6"></div>
      
      <div id="result" class="hidden p-4 rounded-lg"></div>
    </div>
    
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
      <h3 class="font-medium text-blue-900 mb-2">Test Links:</h3>
      <div class="space-y-2 text-sm">
        <a href="/checkout?role=ux-designer" class="block text-blue-600 hover:underline">UX Designer Checkout</a>
        <a href="/checkout?role=lawyer" class="block text-blue-600 hover:underline">Lawyer Checkout</a>
        <a href="/" class="block text-blue-600 hover:underline">Back to Home</a>
      </div>
    </div>
  </div>

  <!-- PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=ATqMLXIdVBcijAV9H8QmYud0idJcGQc-SHKYjhsvIPGSmvHv-Y988y60kljFD6uT6SXrnpkrLLWD4DvI&currency=USD&intent=capture"></script>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="firebase-init.js"></script>
  
  <script>
    // Check Firebase initialization
    document.addEventListener('DOMContentLoaded', function() {
      console.log('üîç Checking Firebase initialization...');
      
      // Wait for Firebase to initialize
      setTimeout(() => {
        if (window.firebase && window.auth) {
          console.log('‚úÖ Firebase initialized successfully');
          console.log('üîë Auth state:', window.auth.currentUser ? 'Logged in' : 'Not logged in');
        } else {
          console.error('‚ùå Firebase not initialized');
        }
      }, 2000);
    });

    paypal.Buttons({
      createOrder: function(data, actions) {
        return actions.order.create({
          purchase_units: [{
            amount: {
              value: '15.00',
              currency_code: 'USD'
            },
            description: 'Test Payment - UX Designer Simulator'
          }]
        });
      },
      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          console.log('Payment successful:', details);
          document.getElementById('result').classList.remove('hidden');
          document.getElementById('result').className = 'p-4 rounded-lg bg-green-100 border border-green-200';
          document.getElementById('result').innerHTML = `
            <h4 class="font-medium text-green-900 mb-2">‚úÖ Payment Successful!</h4>
            <p class="text-green-700 text-sm">Order ID: ${details.id}</p>
            <p class="text-green-700 text-sm">Status: ${details.status}</p>
            <p class="text-green-700 text-sm">Amount: $${details.purchase_units[0].payments.captures[0].amount.value}</p>
          `;
        });
      },
      onError: function(err) {
        console.error('PayPal error:', err);
        document.getElementById('result').classList.remove('hidden');
        document.getElementById('result').className = 'p-4 rounded-lg bg-red-100 border border-red-200';
        document.getElementById('result').innerHTML = `
          <h4 class="font-medium text-red-900 mb-2">‚ùå Payment Error</h4>
          <p class="text-red-700 text-sm">${err.message || 'Unknown error occurred'}</p>
        `;
      },
      onCancel: function(data) {
        console.log('Payment cancelled');
        document.getElementById('result').classList.remove('hidden');
        document.getElementById('result').className = 'p-4 rounded-lg bg-yellow-100 border border-yellow-200';
        document.getElementById('result').innerHTML = `
          <h4 class="font-medium text-yellow-900 mb-2">‚ö†Ô∏è Payment Cancelled</h4>
          <p class="text-yellow-700 text-sm">You cancelled the payment process.</p>
        `;
      }
    }).render('#paypal-button-container');
  </script>
</body>
</html>
